{% extends "base.html" %}
{% block content %}

<!-- Header card -->
<div class="card shadow-sm mb-4 border-0 bg-light bg-opacity-50 hover-lift">
  <div class="card-body d-flex justify-content-between align-items-center">
    <div>
      <h5 class="mb-1">{{ prod.name }}</h5>
      <div class="text-muted small">M√£ s·∫£n ph·∫©m: {{ prod.id }}</div>
    </div>
    <span class="badge bg-primary bg-opacity-25 text-primary fs-6 px-3 py-2 rounded-pill">
      T·ªìn hi·ªán t·∫°i: {{ prod.quantity }}
    </span>
  </div>
</div>

<div class="row g-4">
  <!-- Bi·ªÉu ƒë·ªì b√™n tr√°i -->
  <div class="col-lg-8">
    <div class="card shadow-sm border-0 hover-lift">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="fw-semibold text-secondary">üìä L·ªãch s·ª≠ nh·∫≠p / xu·∫•t theo ng√†y</div>
        </div>
        <canvas id="txChart" height="140"></canvas>
      </div>
    </div>
  </div>

  <!-- Th√¥ng tin chi ti·∫øt b√™n ph·∫£i -->
  <div class="col-lg-4">
    <div class="card shadow-sm border-0 hover-lift h-100">
      <div class="card-body d-flex flex-column">
        <h6 class="fw-semibold mb-3">üìã Th√¥ng tin chi ti·∫øt</h6>
        <ul class="list-unstyled flex-grow-1">
          <li class="mb-2"><span class="text-muted">M√£ SP:</span> <span class="fw-medium">{{ prod.id }}</span></li>
          <li class="mb-2"><span class="text-muted">T√™n SP:</span> <span class="fw-medium">{{ prod.name }}</span></li>
          <li class="mb-2">
            <span class="text-muted">T·ªìn kho:</span> 
            <span class="fw-medium">{{ prod.quantity }}</span>
            {% if prod.quantity > 20 %}
              <span class="badge bg-success bg-opacity-25 text-success">C√≤n h√†ng</span>
            {% elif prod.quantity > 0 %}
              <span class="badge bg-warning bg-opacity-25 text-warning">S·∫Øp h·∫øt</span>
            {% else %}
              <span class="badge bg-danger bg-opacity-25 text-danger">H·∫øt h√†ng</span>
            {% endif %}
          </li>
          <li class="mb-2"><span class="text-muted">V·∫≠t li·ªáu:</span> <span class="fw-medium">{{ prod.material or 'Ch∆∞a c·∫≠p nh·∫≠t' }}</span></li>
          <li class="mb-2"><span class="text-muted">Kh·ªëi l∆∞·ª£ng:</span> <span class="fw-medium">{{ prod.weight or 'Ch∆∞a c·∫≠p nh·∫≠t' }} kg</span></li>
          <li><span class="text-muted">Draw-no:</span> <span class="fw-medium">{{ prod.draw_no or 'Ch∆∞a c·∫≠p nh·∫≠t' }}</span></li>
        </ul>
        
        <!-- N√∫t ch·ªânh s·ª≠a th√¥ng tin -->
        <div class="mt-3 text-end">
          <a href="{{ url_for('product_edit', prod_id=prod.id) }}" 
             class="btn btn-sm btn-outline-primary">
            ‚úèÔ∏è Ch·ªânh s·ª≠a th√¥ng tin
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ChartJS -->
<script>
const labels = {{ labels|tojson }};
const qtyIn = {{ qty_in|tojson }};
const qtyOut = {{ qty_out|tojson }};
const ctx = document.getElementById('txChart');
new Chart(ctx, {
  type: 'bar',
  data: {
    labels: labels,
    datasets: [
      { label: 'Nh·∫≠p h√†ng', data: qtyIn, backgroundColor: 'rgba(99, 200, 132, 0.6)', borderRadius: 6 },
      { label: 'Xu·∫•t h√†ng', data: qtyOut, backgroundColor: 'rgba(255, 99, 132, 0.6)', borderRadius: 6 }
    ]
  },
  options: {
    responsive: true,
    plugins: { 
      legend: { position: 'top' }, 
      title: { display: true, text: 'Bi·ªÉu ƒë·ªì Nh·∫≠p - Xu·∫•t' } 
    },
    scales: { 
      y: { beginAtZero: true, title: {display: true, text: 'S·ªë l∆∞·ª£ng'} }, 
      x: { title: {display: true, text: 'Ng√†y'} } 
    }
  }
});
</script>

{% endblock %}
